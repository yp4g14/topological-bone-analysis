


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Topological Porosity Analysis Example Process &#8212; topological-bone-analysis  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/cloud.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noticia+Text:400,i,b,bi|Open+Sans:400,i,b,bi|Roboto+Mono:400,i,b,bi&amp;display=swap" type="text/css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>

    
    
     
        <script src="../_static/jquery.cookie.js"></script>
    

    
     
        <script src="../_static/cloud.base.js"></script>
    

    
     
        <script src="../_static/cloud.js"></script>
    

    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Modules" href="../modules.html" />
    <link rel="prev" title="Topological-bone-analysis" href="../index.html" /> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../modules.html" title="Modules"
             accesskey="N">next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../index.html" title="Topological-bone-analysis"
             accesskey="P">previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">topological-bone-analysis  documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Topological Porosity Analysis Example Process</a></li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for cloud theme */

/* nicer titles and more space for info and warning logos */

div.admonition p.admonition-title {
    background: rgba(0, 0, 0, .05);
    margin: .5em -1em;
    margin-top: -.5em !important;
    padding: .5em .5em .5em 2.65em;
}

/* indent single paragraph */
div.admonition {
    text-indent: 20px;
}
/* don't indent multiple paragraphs */
div.admonition > p {
    text-indent: 0;
}
/* remove excessive padding */
div.admonition.inline-title p.admonition-title {
    padding-left: .2em;
}
</style>
<section id="Topological-Porosity-Analysis-Example-Process">
<h1>Topological Porosity Analysis Example Process<a class="headerlink" href="#Topological-Porosity-Analysis-Example-Process" title="Permalink to this headline">¶</a></h1>
<p>First load in a couple of images. You should see the first three (left) example images have 20 ‘pores’ and the three on the right have 60 ‘pores’.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">skimage.filters</span> <span class="kn">import</span> <span class="n">threshold_otsu</span>
<span class="kn">import</span> <span class="nn">homcloud.interface</span> <span class="k">as</span> <span class="nn">hc</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">rcParams</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span><span class="p">,</span> <span class="n">TwoSlopeNorm</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;example&quot;</span><span class="p">)</span>
<span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>

<span class="n">src_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="s1">&#39;./../../../src&#39;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">src_path</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">utils</span>
<span class="kn">import</span> <span class="nn">preprocessing_images</span> <span class="k">as</span> <span class="nn">preprocess</span>
<span class="kn">import</span> <span class="nn">persistent_homology_SEDT</span> <span class="k">as</span> <span class="nn">ph</span>
<span class="kn">import</span> <span class="nn">persistence_statistics_per_quadrant</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">import</span> <span class="nn">plots</span> <span class="k">as</span> <span class="nn">plots</span>

<span class="n">path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
<span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;example_ellipses_20_1.tif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;example_ellipses_20_2.tif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;example_ellipses_20_3.tif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;example_ellipses_60_1.tif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;example_ellipses_60_2.tif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;example_ellipses_60_3.tif&quot;</span>
    <span class="p">]</span>

<span class="n">images</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)):</span>
    <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="n">filenames</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>

<span class="c1">#plot the images</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Greys_r&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/example_example_2_0.png" src="../_images/example_example_2_0.png" />
</div>
</div>
<p>Next we want to threshold each image to binary. Here we use Ostu’s thresholding technique.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">binary_images</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">thresholds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">images</span><span class="p">:</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">threshold_otsu</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    <span class="n">thresholds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="n">binary_im</span> <span class="o">=</span> <span class="p">(</span><span class="n">image</span> <span class="o">&gt;</span> <span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">binary_images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binary_im</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Thresholds: </span><span class="si">{</span><span class="n">thresholds</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1">#plot the images</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">gridspec_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;wspace&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;hspace&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">},</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">binary_images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;binary_r&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Thresholds: [89.4389, 91.04787, 90.539795, 88.40241, 88.22197, 88.18486]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/example_example_4_1.png" src="../_images/example_example_4_1.png" />
</div>
</div>
<p>Normally, we’d trim redundant background rows and columns off the binary images. Because these images don’t have background, we include the code and nothing gets trimmed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># trim the images of border rows full of 0s (edge_val)</span>
<span class="n">trimmed_binary_images</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">binary_image</span> <span class="ow">in</span> <span class="n">binary_images</span><span class="p">:</span>
    <span class="n">trimmed_binary_images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">preprocess</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">binary_image</span><span class="p">,</span> <span class="n">edge_val</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>


<span class="c1">#plot the images</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">gridspec_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;wspace&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;hspace&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">},</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">trimmed_binary_images</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;binary_r&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/example_example_6_0.png" src="../_images/example_example_6_0.png" />
</div>
</div>
<p>Next we want to take non overlapping patches of each image, here we’re going to take 100 x 100 pixels square patches. This requires us to pad the images to integer mutliples of the patch shape, so that all patches are the same size. We can also discard all patches that are entirely background (all 0s) for both images, which in this case is none.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># pad the binary images and cut into 100 x 100 pixels patches</span>
<span class="n">patch_shape</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">pad_val</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">background_val</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">padded_images</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">patches_per_image</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">patch_coords</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">padded_shape</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">image</span> <span class="ow">in</span> <span class="n">trimmed_binary_images</span><span class="p">:</span>
    <span class="c1"># extracts square patches size patch_size x patch_size stride apart</span>
    <span class="n">padded_image</span><span class="p">,</span> <span class="n">patches</span><span class="p">,</span> <span class="n">coords</span> <span class="o">=</span> <span class="n">preprocess</span><span class="o">.</span><span class="n">extract_patches</span><span class="p">(</span>
        <span class="n">image</span><span class="p">,</span>
        <span class="n">patch_shape</span><span class="p">,</span>
        <span class="n">pad_val</span><span class="o">=</span><span class="n">pad_val</span><span class="p">,</span>
        <span class="n">stride</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">padded_images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">padded_image</span><span class="p">)</span>
    <span class="n">padded_shape</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">padded_image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="n">patches_to_keep</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">patch_coords_to_keep</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">patches_discarded</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">patches</span><span class="p">)):</span>
        <span class="n">patch</span> <span class="o">=</span> <span class="n">patches</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="n">coord</span> <span class="o">=</span> <span class="n">coords</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="c1"># how much of the patch is background?</span>
        <span class="n">patch_background_percentage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">patch</span> <span class="o">&lt;=</span> <span class="n">background_val</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">patch_shape</span><span class="o">*</span><span class="n">patch_shape</span><span class="p">)</span>
        <span class="c1"># keep patch if it&#39;s not entirely background</span>
        <span class="k">if</span>  <span class="p">(</span><span class="n">patch_background_percentage</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">):</span>
            <span class="n">patches_to_keep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">patch</span><span class="p">)</span>
            <span class="n">patch_coords_to_keep</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>

    <span class="n">patches_per_image</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">patches_to_keep</span><span class="p">)</span>
    <span class="n">patch_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">patch_coords_to_keep</span><span class="p">)</span>

</pre></div>
</div>
</div>
<p>We can plot the patches for one of the images (last one). Alter s between [0,5] below to show the other images.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">s</span><span class="o">=</span><span class="mi">5</span>

<span class="c1"># plot the binary patches for the last image</span>
<span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">padded_shape</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">patch_shape</span><span class="p">)</span>
<span class="n">cols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">padded_shape</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">patch_shape</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="p">,</span><span class="n">gridspec_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;wspace&#39;</span><span class="p">:</span><span class="mf">0.</span><span class="p">,</span> <span class="s1">&#39;hspace&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">},</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="o">*</span><span class="n">cols</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">patch_coords</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">patch_shape</span><span class="p">)</span>
    <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">patch_coords</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">patch_shape</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">patches_per_image</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">k</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;binary_r&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/example_example_10_0.png" src="../_images/example_example_10_0.png" />
</div>
</div>
<p>Perform a signed Euclidean distance transform per patch</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">SEDT_patches_per_image</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">patches</span> <span class="ow">in</span> <span class="n">patches_per_image</span><span class="p">:</span>
    <span class="n">SEDT_patches</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">patches</span><span class="p">)):</span>
        <span class="n">SEDT_patch</span> <span class="o">=</span> <span class="n">preprocess</span><span class="o">.</span><span class="n">SEDT</span><span class="p">(</span><span class="n">patches</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">SEDT_patches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SEDT_patch</span><span class="p">)</span>
    <span class="n">SEDT_patches_per_image</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SEDT_patches</span><span class="p">)</span>

</pre></div>
</div>
</div>
<p>Let’s plot the signed Euclidean distance transform of some patches. To do the same for other images, set s to an integer in [0,5]</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># get the SEDT patches for image s</span>
<span class="n">s</span><span class="o">=</span> <span class="mi">0</span>

<span class="c1"># make custom colourmap, set zero as midpoint</span>
<span class="n">specific_colors</span> <span class="o">=</span> <span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span>
    <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">),(</span><span class="mf">0.3</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">),(</span><span class="mf">0.5</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">),(</span><span class="mf">0.8</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)],</span><span class="n">N</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span><span class="n">cols</span><span class="p">,</span><span class="n">gridspec_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;wspace&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;hspace&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">},</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="o">*</span><span class="n">cols</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">patch_coords</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">patch_shape</span><span class="p">)</span>
    <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">patch_coords</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">patch_shape</span><span class="p">)</span>
    <span class="n">SEDT_patch</span> <span class="o">=</span> <span class="n">SEDT_patches_per_image</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
    <span class="n">vmin</span><span class="p">,</span> <span class="n">vcenter</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">SEDT_patch</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">SEDT_patch</span><span class="p">)</span>
    <span class="n">divnorm</span> <span class="o">=</span> <span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vcenter</span><span class="o">=</span><span class="n">vcenter</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">SEDT_patch</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">specific_colors</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">divnorm</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">divider</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
    <span class="n">cax</span> <span class="o">=</span> <span class="n">divider</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="n">vmin</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="p">])</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/example_example_14_0.png" src="../_images/example_example_14_0.png" />
</div>
</div>
<p>Calculate the persistent homology for all the patches, using the signed Euclidean distance transform. This process produces .idiagram files, which will need to be saved out and csv files of the persistence diagrams as birth death intervals, for H0 and H1 respectively.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># calculate sublevel set cubical homology persistence for each image</span>

<span class="n">idiagram_path</span><span class="o">=</span> <span class="n">path</span><span class="o">+</span><span class="s1">&#39;idiagrams/&#39;</span>
<span class="n">utils</span><span class="o">.</span><span class="n">directory</span><span class="p">(</span><span class="n">idiagram_path</span><span class="p">)</span>
<span class="n">interval_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">+</span><span class="s1">&#39;persistence_intervals/&#39;</span>
<span class="n">utils</span><span class="o">.</span><span class="n">directory</span><span class="p">(</span><span class="n">interval_path</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">SEDT_patches</span> <span class="o">=</span> <span class="n">SEDT_patches_per_image</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SEDT_patches</span><span class="p">))):</span>
        <span class="n">SEDT_patch</span> <span class="o">=</span> <span class="n">SEDT_patches</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filenames</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">_patch_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">SEDT&quot;</span>
        <span class="n">ph</span><span class="o">.</span><span class="n">peristent_homology_sublevel_cubic</span><span class="p">(</span>
            <span class="n">SEDT_patch</span><span class="p">,</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="n">path</span><span class="p">,</span>
            <span class="n">plot_persistence_diagrams</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 9/9 [00:01&lt;00:00,  5.67it/s]
100%|██████████| 9/9 [00:01&lt;00:00,  4.81it/s]
100%|██████████| 9/9 [00:02&lt;00:00,  4.37it/s]
100%|██████████| 9/9 [00:03&lt;00:00,  2.78it/s]
100%|██████████| 9/9 [00:01&lt;00:00,  5.13it/s]
100%|██████████| 9/9 [00:02&lt;00:00,  4.49it/s]
</pre></div></div>
</div>
<p>Now we need to read all the persistence diagrams (interval) files. Then calculate the statistics per quadrant for each persistence diagram. Split radius can be set to count the number of pores with radius less than or greater than or equal to a specific value. It’s faster to save out a statistics file per persistence diagram, then combine into a single file.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">interval_filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">file</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">interval_path</span><span class="p">)</span>
                      <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">interval_path</span><span class="p">,</span> <span class="n">file</span><span class="p">))]</span>
<span class="n">interval_files</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">interval_filenames</span><span class="p">:</span>
    <span class="n">interval_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
            <span class="n">interval_path</span><span class="o">+</span><span class="n">name</span><span class="p">,</span>
            <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;birth&#39;</span><span class="p">,</span><span class="s1">&#39;death&#39;</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>

<span class="n">stats_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">+</span><span class="s1">&#39;stats/&#39;</span>
<span class="n">utils</span><span class="o">.</span><span class="n">directory</span><span class="p">(</span><span class="n">stats_path</span><span class="p">)</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">interval_files</span><span class="p">)):</span>
    <span class="n">dim</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">interval_filenames</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">7</span><span class="p">])</span>
    <span class="n">stats</span><span class="o">.</span><span class="n">quadrant_statistics</span><span class="p">(</span>
        <span class="n">interval_files</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
        <span class="n">dim</span><span class="p">,</span>
        <span class="n">interval_filenames</span><span class="p">[</span><span class="n">j</span><span class="p">],</span>
        <span class="n">stats_path</span><span class="p">,</span>
        <span class="n">split_radius</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># combine all statistics files</span>
<span class="n">stats_df</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">combine_stats_files</span><span class="p">(</span>
    <span class="n">stats_path</span><span class="p">,</span>
    <span class="n">path</span><span class="p">,</span>
    <span class="s2">&quot;all_statistics.csv&quot;</span><span class="p">,</span>
    <span class="n">logger</span>
    <span class="p">)</span>
<span class="c1"># delete individual files &amp; location</span>
<span class="n">stats_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">stats_path</span><span class="o">+</span><span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">stats_path</span><span class="p">)]</span>
<span class="n">os</span><span class="o">.</span><span class="n">rmdir</span><span class="p">(</span><span class="n">stats_path</span><span class="p">)</span>

</pre></div>
</div>
</div>
<p>Now that we’ve calculated the persistence statistics, lets look at some plots! To compare, we’ll group patches from the first three images with 20 pores together, and likewise for the patches from images with 60 pores. Also, we’ll look at a specific subset of the statistic, as specified in feature_cols.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># read in full statistics dataframe</span>
<span class="n">stats_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;all_statistics.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">plot_path</span> <span class="o">=</span> <span class="n">path</span><span class="o">+</span><span class="s1">&#39;plots/&#39;</span>
<span class="n">utils</span><span class="o">.</span><span class="n">directory</span><span class="p">(</span><span class="n">plot_path</span><span class="p">)</span>

<span class="n">filenames_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;example_ellipses_20_1.tif&quot;</span><span class="p">:</span><span class="s2">&quot;group_a&quot;</span><span class="p">,</span>
    <span class="s2">&quot;example_ellipses_20_2.tif&quot;</span><span class="p">:</span><span class="s2">&quot;group_a&quot;</span><span class="p">,</span>
    <span class="s2">&quot;example_ellipses_20_3.tif&quot;</span><span class="p">:</span><span class="s2">&quot;group_a&quot;</span><span class="p">,</span>
    <span class="s2">&quot;example_ellipses_60_1.tif&quot;</span><span class="p">:</span><span class="s2">&quot;group_b&quot;</span><span class="p">,</span>
    <span class="s2">&quot;example_ellipses_60_2.tif&quot;</span><span class="p">:</span><span class="s2">&quot;group_b&quot;</span><span class="p">,</span>
    <span class="s2">&quot;example_ellipses_60_3.tif&quot;</span><span class="p">:</span><span class="s2">&quot;group_b&quot;</span>
    <span class="p">}</span>

<span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;0_num_points_less_eq_-2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_avg_birth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_avg_death&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_stddev_birth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_stddev_death&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_pers_entropy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_num_points&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_avg_birth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_avg_death&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_pers_entropy&#39;</span><span class="p">]</span>
<span class="n">stats_df</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats_df</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.tif&#39;</span><span class="p">)</span>

<span class="n">plots</span><span class="o">.</span><span class="n">analysis_plots</span><span class="p">(</span>
    <span class="n">stats_df</span><span class="p">,</span>
    <span class="n">filenames_map</span><span class="p">,</span>
    <span class="n">plot_path</span><span class="p">,</span>
    <span class="n">feature_cols</span><span class="p">)</span>

<span class="k">for</span> <span class="n">quadrant</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]:</span>
    <span class="n">utils</span><span class="o">.</span><span class="n">directory</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">plot_path</span><span class="si">}</span><span class="s2">Q</span><span class="si">{</span><span class="n">quadrant</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># create category map from filenames dictionary</span>
<span class="n">stats_df</span><span class="p">[</span><span class="s1">&#39;category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats_df</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">filenames_map</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="n">gridspec_kw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;wspace&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;hspace&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">},</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">k</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span>
        <span class="n">row</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">k</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">row</span><span class="p">,</span><span class="n">cols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="o">-</span><span class="mi">5</span>
    <span class="k">for</span> <span class="n">quadrant</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]:</span>
        <span class="n">stats_quad</span> <span class="o">=</span> <span class="n">stats_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">stats_df</span><span class="p">[</span><span class="s1">&#39;quadrant&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">quadrant</span><span class="p">]</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">feature_cols</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">single_stat</span> <span class="o">=</span> <span class="n">stats_quad</span><span class="p">[[</span><span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="n">col</span><span class="p">]]</span>
        <span class="n">single_stat</span> <span class="o">=</span> <span class="n">single_stat</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">single_stat</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">row</span><span class="p">,</span><span class="n">cols</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;category&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">single_stat</span><span class="p">,</span> <span class="n">dodge</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/example_example_20_0.png" src="../_images/example_example_20_0.png" />
</div>
</div>
<p>We can visualise the statistics per patch back on the entire image:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">visualise_patch_scores</span> <span class="k">as</span> <span class="nn">vis</span>
<span class="n">utils</span><span class="o">.</span><span class="n">directory</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;visualise/&#39;</span><span class="p">)</span>
<span class="n">stats_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="o">+</span><span class="s1">&#39;all_statistics.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">stats_df</span> <span class="o">=</span> <span class="n">stats_df</span><span class="p">[</span><span class="n">stats_df</span><span class="p">[</span><span class="s1">&#39;quadrant&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2</span><span class="p">]</span>

<span class="n">scores</span> <span class="o">=</span> <span class="n">stats_df</span><span class="p">[[</span><span class="s1">&#39;filename&#39;</span><span class="p">,</span> <span class="s1">&#39;patch_number&#39;</span><span class="p">,</span><span class="s1">&#39;0_num_points_less_eq_-2&#39;</span><span class="p">]]</span>
<span class="n">coords_row_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]))</span>
<span class="n">coords_col_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">]))</span>
<span class="n">scores</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;.tif&#39;</span><span class="p">)</span>
<span class="n">scores</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;coord_array_row&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="s1">&#39;patch_number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">coords_row_map</span><span class="p">)</span>
<span class="n">scores</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;coord_array_col&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="s1">&#39;patch_number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">coords_col_map</span><span class="p">)</span>
<span class="n">scores</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;image_shape_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">scores</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;image_shape_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">300</span>
<span class="n">scores</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;patch_width&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">scores</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">&#39;patch_height&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">scores</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;0_num_points_less_eq_-2&#39;</span><span class="p">])</span>

<span class="n">vis</span><span class="o">.</span><span class="n">plot_patch_scores</span><span class="p">(</span>
    <span class="n">trimmed_binary_images</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">scores</span><span class="p">,</span>
    <span class="n">path</span><span class="o">+</span><span class="s1">&#39;visualise/&#39;</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">,</span>
    <span class="n">colour</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">,</span>
    <span class="n">normalise_scores</span><span class="o">=</span><span class="s1">&#39;no&#39;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">score_column</span><span class="o">=</span><span class="s1">&#39;0_num_points_less_eq_-2&#39;</span>
<span class="p">)</span>
<span class="n">vis_plot</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">visualise/</span><span class="si">{</span><span class="n">filenames</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="s2">_0_num_points_less_eq_-2_Blues.png&quot;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">vis_plot</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
C:\Apps\Anaconda3\lib\site-packages\ipykernel_launcher.py:11: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  # This is added back by InteractiveShellApp.init_path()
C:\Apps\Anaconda3\lib\site-packages\pandas\core\indexing.py:1596: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self.obj[key] = value
C:\Apps\Anaconda3\lib\site-packages\pandas\core\indexing.py:1675: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self._setitem_single_column(ilocs[0], value, pi)
C:\Apps\Anaconda3\lib\site-packages\pandas\core\indexing.py:1719: SettingWithCopyWarning:
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  self._setitem_single_column(loc, value, pi)
[300]
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-0.5, 1079.5, 935.5, -0.5)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/example_example_22_2.png" src="../_images/example_example_22_2.png" />
</div>
</div>
<p>These persistence statistcs (and many others that we can calculate) can be used for classification with a support vector machine.</p>
<p>Below, we demonstrate how to run the entire process, using the main function in run_process.py. Results save in example folder in current date/time folder for each run.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
<span class="n">feature_cols</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;0_num_points&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_num_points_less_eq_-2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_avg_birth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_stddev_birth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_skew_birth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_percentile_25_birth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_percentile_75_birth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_iqr_birth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_avg_death&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_stddev_death&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_skew_death&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_percentile_25_death&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_percentile_75_death&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_iqr_death&#39;</span><span class="p">,</span>
    <span class="s1">&#39;0_pers_entropy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_num_points&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_avg_birth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_stddev_birth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_skew_birth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_percentile_25_birth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_percentile_75_birth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_iqr_birth&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_avg_death&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_stddev_death&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_skew_death&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_percentile_25_death&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_percentile_75_death&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_iqr_death&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1_pers_entropy&#39;</span><span class="p">]</span>
<span class="n">filenames_map</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;example_ellipses_20_1.tif&quot;</span><span class="p">:</span><span class="s2">&quot;group_a&quot;</span><span class="p">,</span>
    <span class="s2">&quot;example_ellipses_20_2.tif&quot;</span><span class="p">:</span><span class="s2">&quot;group_a&quot;</span><span class="p">,</span>
    <span class="s2">&quot;example_ellipses_20_3.tif&quot;</span><span class="p">:</span><span class="s2">&quot;group_a&quot;</span><span class="p">,</span>
    <span class="s2">&quot;example_ellipses_60_1.tif&quot;</span><span class="p">:</span><span class="s2">&quot;group_b&quot;</span><span class="p">,</span>
    <span class="s2">&quot;example_ellipses_60_2.tif&quot;</span><span class="p">:</span><span class="s2">&quot;group_b&quot;</span><span class="p">,</span>
    <span class="s2">&quot;example_ellipses_60_3.tif&quot;</span><span class="p">:</span><span class="s2">&quot;group_b&quot;</span>
    <span class="p">}</span>
<span class="kn">import</span> <span class="nn">run_process</span> <span class="k">as</span> <span class="nn">run_process</span>
<span class="n">stats_df</span><span class="p">,</span> <span class="n">results</span> <span class="o">=</span> <span class="n">run_process</span><span class="o">.</span><span class="n">topological_porosity_analysis</span><span class="p">(</span>
    <span class="n">path</span><span class="p">,</span>
    <span class="n">logger</span><span class="p">,</span>
    <span class="n">preprocess</span><span class="o">.</span><span class="n">otsu_threshold</span><span class="p">,</span>
    <span class="n">patch_shape</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">stride</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">save_persistence_diagrams</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">analysis_plots</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">classification</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">feature_cols</span><span class="o">=</span><span class="n">feature_cols</span><span class="p">,</span>
    <span class="n">filenames_map</span><span class="o">=</span><span class="n">filenames_map</span><span class="p">,</span>
    <span class="n">runs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">strat_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">cross_val</span><span class="o">=</span><span class="s1">&#39;stratkfold&#39;</span><span class="p">,</span>
    <span class="n">param_grid_SVC</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;kernel&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span><span class="s1">&#39;linear&#39;</span><span class="p">)}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Files dropped incorrect extensions: [&#39;all_statistics.csv&#39;, &#39;example.ipynb&#39;]
runs: 100%|██████████| 10/10 [00:07&lt;00:00,  1.26it/s]
</pre></div></div>
</div>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="../index.html"
                          title="Previous page">&larr; Topological-bone-analysis</a></p>
  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="../modules.html"
                          title="Next page">&rarr; Modules</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/example/example.ipynb.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../modules.html" title="Modules"
             >next</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="../index.html" title="Topological-bone-analysis"
             >previous</a> &nbsp; &nbsp;</li>
    <li><a href="../index.html">topological-bone-analysis  documentation</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Topological Porosity Analysis Example Process</a></li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Ysanne Pritchard.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.3.0.
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>